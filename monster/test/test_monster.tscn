[gd_scene load_steps=25 format=3 uid="uid://cwffmeeyd6sgu"]

[ext_resource type="Shader" path="res://shader/sheet_outline.gdshader" id="1_bxdlx"]
[ext_resource type="Script" path="res://monster/monster.gd" id="1_e686l"]
[ext_resource type="Script" path="res://components/state_machine.gd" id="2_wxuav"]
[ext_resource type="Script" path="res://components/state.gd" id="3_4420w"]
[ext_resource type="Script" path="res://components/health.gd" id="3_xunb3"]
[ext_resource type="Script" path="res://components/interactable.gd" id="4_jcere"]
[ext_resource type="Texture2D" uid="uid://bh201qypfnlf7" path="res://monster/monster.png" id="4_wbmr4"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_m1f0r"]
shader = ExtResource("1_bxdlx")
shader_parameter/color = Color(1, 1, 1, 1)
shader_parameter/width = 1.0
shader_parameter/pattern = 1
shader_parameter/inside = false
shader_parameter/add_margins = true
shader_parameter/number_of_images = Vector2(1, 1)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_db0ey"]
size = Vector2(12.1081, 9)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_nut2t"]
resource_local_to_scene = true
shader = ExtResource("1_bxdlx")
shader_parameter/color = Color(1, 1, 1, 1)
shader_parameter/width = 1.0
shader_parameter/pattern = 1
shader_parameter/inside = false
shader_parameter/add_margins = true
shader_parameter/number_of_images = Vector2(1, 1)

[sub_resource type="Animation" id="Animation_4lvg5"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:skew")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Sprite:rotation")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Sprite:scale")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(1, 1)]
}

[sub_resource type="Animation" id="Animation_kxoce"]
resource_name = "idle"
length = 2.5
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:skew")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Sprite:rotation")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Sprite:scale")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0, 1.1, 2.5),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Vector2(1, 1), Vector2(1.05, 0.95), Vector2(1, 1)]
}

[sub_resource type="Animation" id="Animation_4oew6"]
resource_name = "run"
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:skew")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6, 0.8),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1),
"update": 0,
"values": [0.0, 0.174533, 0.0, -0.174533, 0.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Sprite:rotation")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.2, 0.4, 0.6, 0.8),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1),
"update": 0,
"values": [0.0, -0.174533, 0.0, 0.174533, 0.0]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Sprite:scale")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(1, 1)]
}

[sub_resource type="Animation" id="Animation_uolog"]
resource_name = "feeded"
length = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Sprite:scale")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.5),
"transitions": PackedFloat32Array(1.62451, 2, 1),
"update": 0,
"values": [Vector2(1, 1), Vector2(0.8, 1.2), Vector2(1, 1)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_b7nvd"]
_data = {
"RESET": SubResource("Animation_4lvg5"),
"feeded": SubResource("Animation_uolog"),
"idle": SubResource("Animation_kxoce"),
"run": SubResource("Animation_4oew6")
}

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_p6ptm"]
animation = &"run"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_nv6kw"]
animation = &"feeded"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_7yc8n"]
animation = &"idle"

[sub_resource type="AnimationNodeBlend2" id="AnimationNodeBlend2_lxaf2"]

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_pdgt1"]
filters = ["Sprite:rotation", "Sprite:scale", "Sprite:skew"]
mix_mode = 1

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_k2he7"]
graph_offset = Vector2(-262.208, -33.7456)
nodes/Animation/node = SubResource("AnimationNodeAnimation_7yc8n")
nodes/Animation/position = Vector2(-160, 0)
"nodes/Animation 2/node" = SubResource("AnimationNodeAnimation_p6ptm")
"nodes/Animation 2/position" = Vector2(-160, 140)
"nodes/Animation 3/node" = SubResource("AnimationNodeAnimation_nv6kw")
"nodes/Animation 3/position" = Vector2(140, 200)
nodes/Blend2/node = SubResource("AnimationNodeBlend2_lxaf2")
nodes/Blend2/position = Vector2(0, 20)
nodes/OneShot/node = SubResource("AnimationNodeOneShot_pdgt1")
nodes/OneShot/position = Vector2(320, 100)
nodes/output/position = Vector2(560, 140)
node_connections = [&"Blend2", 0, &"Animation", &"Blend2", 1, &"Animation 2", &"OneShot", 0, &"Blend2", &"OneShot", 1, &"Animation 3", &"output", 0, &"OneShot"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_wu04j"]
size = Vector2(23, 18.5)

[sub_resource type="LabelSettings" id="LabelSettings_4hu0g"]
font_size = 8

[sub_resource type="LabelSettings" id="LabelSettings_ec72f"]
font_size = 8

[node name="TestMonster" type="CharacterBody2D"]
material = SubResource("ShaderMaterial_m1f0r")
collision_layer = 16
collision_mask = 17
script = ExtResource("1_e686l")
tame_outline_color = Color(0.760784, 0.827451, 0.407843, 1)
selected_outline_color = Color(0.811765, 0.541176, 0.796078, 1)

[node name="Health" type="Node" parent="."]
script = ExtResource("3_xunb3")

[node name="Interactable" type="Node" parent="."]
script = ExtResource("4_jcere")

[node name="StateMachine" type="Node" parent="."]
script = ExtResource("2_wxuav")
start_state = NodePath("TamingPhase1")

[node name="TamingPhase1" type="Node" parent="StateMachine"]
script = ExtResource("3_4420w")

[node name="TamingPhase2" type="Node" parent="StateMachine"]
script = ExtResource("3_4420w")

[node name="Preperation" type="Node" parent="StateMachine"]
script = ExtResource("3_4420w")

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(0, -1)
shape = SubResource("RectangleShape2D_db0ey")

[node name="Sprite" type="Sprite2D" parent="."]
material = SubResource("ShaderMaterial_nut2t")
position = Vector2(0, -5)
texture = ExtResource("4_wbmr4")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_b7nvd")
}
autoplay = "idle"
playback_default_blend_time = 0.2

[node name="AnimationTree" type="AnimationTree" parent="."]
libraries = {
"": SubResource("AnimationLibrary_b7nvd")
}
tree_root = SubResource("AnimationNodeBlendTree_k2he7")
anim_player = NodePath("../AnimationPlayer")
parameters/Blend2/blend_amount = 0.0
parameters/OneShot/active = false
parameters/OneShot/internal_active = false
parameters/OneShot/request = 0

[node name="InteractArea" type="Area2D" parent="."]
collision_layer = 0
collision_mask = 14
monitorable = false

[node name="CollisionShape2D" type="CollisionShape2D" parent="InteractArea"]
position = Vector2(0, -1)
shape = SubResource("RectangleShape2D_wu04j")

[node name="InteractLabel" type="Label" parent="."]
visible = false
offset_left = -41.0
offset_top = 1.0
offset_right = 41.0
offset_bottom = 24.0
text = "'e' to tame"
label_settings = SubResource("LabelSettings_4hu0g")
horizontal_alignment = 1

[node name="HealthLabel" type="Label" parent="."]
visible = false
offset_left = -20.0
offset_top = -20.0
offset_right = 20.0
offset_bottom = 3.0
text = "5/10"
label_settings = SubResource("LabelSettings_ec72f")
horizontal_alignment = 1

[connection signal="health_changed" from="Health" to="." method="_on_health_changed"]
[connection signal="deselected" from="Interactable" to="." method="_on_deselected"]
[connection signal="interacted" from="Interactable" to="." method="_on_interacted"]
[connection signal="selected" from="Interactable" to="." method="_on_selected"]
[connection signal="state_switched" from="StateMachine" to="." method="_on_state_switched"]
[connection signal="state_entered" from="StateMachine/TamingPhase1" to="." method="_on_taming_phase_1_state_entered"]
[connection signal="state_entered" from="StateMachine/TamingPhase2" to="." method="_on_taming_phase_2_state_entered"]
[connection signal="state_entered" from="StateMachine/Preperation" to="." method="_on_preperation_state_entered"]
[connection signal="body_entered" from="InteractArea" to="." method="_on_interact_area_body_entered"]
